<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Narita Navigator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    :root{--muted:#6b7280}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;color:#0f172a;background:#f3efe9}
    .page-bg{position:fixed;inset:0;background-image:url('/assets/window-bg.jpg');background-size:cover;background-position:center;filter:saturate(.95) contrast(1);z-index:-2}
    .page-overlay{position:fixed;inset:0;background:linear-gradient(rgba(255,255,255,.6),rgba(255,250,245,.6));z-index:-1;backdrop-filter:blur(2px)}
    .card{background:rgba(255,255,255,.92);backdrop-filter:blur(4px)}
    .pb-20{padding-bottom:7rem}
    .thumb{width:64px;height:48px;object-fit:cover;border-radius:6px;margin-right:.75rem;border:1px solid rgba(0,0,0,.06)}
  </style>
</head>
<body>
  <div class="page-bg" aria-hidden="true"></div>
  <div class="page-overlay" aria-hidden="true"></div>

  <div id="app" class="pb-20">
    <header class="sticky top-0 z-10">
      <div class="max-w-md mx-auto p-4 flex justify-between items-center card shadow-md rounded-b-xl" style="background:linear-gradient(90deg,#fffdfa,#f8fbff)">
        <h1 class="text-2xl font-bold text-gray-800">Narita Navigator <span>‚ùÑÔ∏è</span></h1>
        <div class="text-sm text-[var(--muted)]">Dec 2025</div>
      </div>
    </header>

    <main class="max-w-md mx-auto p-4">
      <!-- Tabs content (schedule/map/spending/shopping) -->
      <!-- Only include shopping tab snippet here; full file includes all other tabs similar to earlier versions -->
      <div v-if="activeTab === 'shopping'">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">üõçÔ∏è Shopping List</h2>

        <div class="card p-4 rounded-xl shadow-lg mb-6">
          <h3 class="font-semibold mb-2">Add a New Item</h3>
          <div class="flex mb-2 space-x-2">
            <input v-model="newShoppingItem" @keyup.enter="addShoppingItem" type="text" placeholder="Add a new item..." class="flex-grow border rounded-lg p-2">
            <button @click="addShoppingItem" class="bg-sky-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-700">Add</button>
          </div>

          <div class="flex items-center space-x-3">
            <label class="flex items-center space-x-2 cursor-pointer">
              <input ref="fileInput" @change="onShoppingImageSelected" accept="image/*" type="file" class="hidden">
              <span class="inline-block bg-white border rounded px-3 py-1 text-sm text-gray-700 shadow-sm">Choose image</span>
            </label>

            <div v-if="selectedShoppingImageData" class="flex items-center space-x-2">
              <img :src="selectedShoppingImageData" class="thumb" alt="preview">
              <button @click="clearSelectedImage" class="text-sm text-red-500 hover:underline">Remove</button>
            </div>
            <p class="text-sm text-gray-500 ml-auto">Max 1 MB</p>
          </div>
          <p v-if="shoppingError" class="text-sm text-red-500 mt-2">{{ shoppingError }}</p>
        </div>

        <div class="card rounded-xl shadow-lg p-4">
          <ul class="divide-y divide-gray-200">
            <li v-for="(item,index) in shoppingList" :key="index" class="py-3 flex items-center">
              <div class="flex items-center flex-grow">
                <img v-if="item.image" :src="item.image" class="thumb" alt="item image">
                <label :class="{'line-through text-gray-400': item.done}" class="ml-3 text-gray-800 flex-grow">{{ item.text }}</label>
              </div>
              <div class="flex items-center space-x-3">
                <input type="checkbox" v-model="item.done" class="h-5 w-5 rounded text-blue-500 border-gray-300 focus:ring-blue-500">
                <button @click="removeShoppingItem(index)" class="text-sm text-red-500 hover:underline">Delete</button>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- Bottom nav omitted here for brevity; include from previous versions -->
    </main>
  </div>

  <script>
    const { createApp } = Vue
    createApp({
      data(){ return {
        activeTab: 'shopping',
        shoppingList: [
          { text: 'Japanese KitKat flavors', done: false, image: null },
          { text: 'Heattech clothing from Uniqlo', done: false, image: null }
        ],
        newShoppingItem: '',
        selectedShoppingImageData: null,
        shoppingError: ''
      }},
      methods:{
        saveState(){ try{ localStorage.setItem('narita.shopping', JSON.stringify(this.shoppingList)) }catch(e){console.warn(e)}},
        loadState(){ try{ const s=localStorage.getItem('narita.shopping'); if(s) this.shoppingList = JSON.parse(s)}catch(e){console.warn(e)}},
        addShoppingItem(){
          this.shoppingError=''
          const text=(this.newShoppingItem||'').trim()
          if(!text){ this.shoppingError='Please enter an item name.'; return }
          this.shoppingList.push({ text, done:false, image: this.selectedShoppingImageData || null })
          this.newShoppingItem=''
          this.selectedShoppingImageData=null
          if(this.$refs?.fileInput) this.$refs.fileInput.value = ''
          this.saveState()
        },
        removeShoppingItem(i){ this.shoppingList.splice(i,1); this.saveState() },
        onShoppingImageSelected(e){
          this.shoppingError=''
          const file=e.target.files?.[0]; if(!file) return
          if(!file.type.startsWith('image/')){ this.shoppingError='Please select an image file.'; e.target.value=''; return }
          const maxBytes = 1024*1024
          if(file.size>maxBytes){ this.shoppingError='Image too large. Use < 1MB.'; e.target.value=''; return }
          const reader = new FileReader()
          reader.onload = (ev)=> this.selectedShoppingImageData = ev.target.result
          reader.onerror = ()=> { this.shoppingError='Failed to read image.'; this.selectedShoppingImageData=null }
          reader.readAsDataURL(file)
        },
        clearSelectedImage(){ this.selectedShoppingImageData = null; if(this.$refs?.fileInput) this.$refs.fileInput.value = '' }
      },
      mounted(){ this.loadState() }
    }).mount('#app')
  </script>
</body>
</html>
